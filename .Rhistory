knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = '/home/tkastylevsky/results/bedtools_analysis')
library(csv)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(ggsci)
#shape_intersect = function(path){
path = "/home/tkastylevsky/results/results_bedtools/chr1_libchr1_ref_chr1.txt"
rep_intersect = read.csv(path, header=TRUE,sep = "\t")
rep_intersect$repeat_class_B = gsub("?",'',rep_intersect$repeat_class_B, fixed = TRUE)
View(rep_intersect)
#shape_intersect = function(path){
path = "/home/tkastylevsky/results/results_bedtools/chr1_libchr1_ref_chr1.txt"
rep_intersect = read.csv(path, header=FALSE,sep = "\t")
rep_intersect$repeat_class_B = gsub("?",'',rep_intersect$repeat_class_B, fixed = TRUE)
#shape_intersect = function(path){
path = "/home/tkastylevsky/results/results_bedtools/chr1_libchr1_ref_chr1.txt"
rep_intersect = read.csv(path, header=FALSE,sep = "\t")
colnames(rep_intersect) = ['A_query_seq','A_method','A_class','A_start','A_end', 'A_perc_div','A_strand','A_phase','A_ID','B_query_seq','B_method','B_class','B_start','B_end', 'B_perc_div','B_strand','B_phase','B_ID','intersect']
#shape_intersect = function(path){
path = "/home/tkastylevsky/results/results_bedtools/chr1_libchr1_ref_chr1.txt"
rep_intersect = read.csv(path, header=FALSE,sep = "\t")
names(rep_intersect) = ['A_query_seq','A_method','A_class','A_start','A_end', 'A_perc_div','A_strand','A_phase','A_ID','B_query_seq','B_method','B_class','B_start','B_end', 'B_perc_div','B_strand','B_phase','B_ID','intersect']
#shape_intersect = function(path){
path = "/home/tkastylevsky/results/results_bedtools/chr1_libchr1_ref_chr1.txt"
rep_intersect = read.csv(path, header=FALSE,sep = "\t")
names(rep_intersect) = list('A_query_seq','A_method','A_class','A_start','A_end', 'A_perc_div','A_strand','A_phase','A_ID','B_query_seq','B_method','B_class','B_start','B_end', 'B_perc_div','B_strand','B_phase','B_ID','intersect')
rep_intersect$repeat_class_B = gsub("?",'',rep_intersect$repeat_class_B, fixed = TRUE)
"bb"+"cc"
library(csv)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(ggsci)
N=as.string(commandArgs(TRUE)[1])
path = "/home/tkastylevsky/results/bedtools_analysis/chr1_libchr1VSref_chr1/data_chr1_libchr1_ref_chr1.csv"
rep_intersect = read.csv(path, header=TRUE,sep = "\t")
View(rep_intersect)
rep_intersect = read.csv(path, header=TRUE)
path = "/home/tkastylevsky/results/bedtools_analysis/chr1_libchr1VSref_chr1/data_chr1_libchr1_ref_chr1.csv"
rep_intersect = read.csv(path, header=TRUE,sep = "\t")
path = "/home/tkastylevsky/results/bedtools_analysis/chr1_libchr1VSref_chr1/data_chr1_libchr1_ref_chr1.csv"
rep_intersect = read.csv(path, header=TRUE)
View(rep_intersect)
rep_intersect$repeat_class_B = gsub("?",'',rep_intersect$repeat_class_B, fixed = TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
path_data = paste(path,"data_chr1_libchr1_ref_chr1.csv")
path_data
path = "/home/tkastylevsky/results/bedtools_analysis/chr1_libchr1VSref_chr1/"
path_data = paste(path,"data_chr1_libchr1_ref_chr1.csv")
path_data
path_data = paste(path,"data_chr1_libchr1_ref_chr1.csv", sep = "")
path_data = paste(path,"data_chr1_libchr1_ref_chr1.csv", sep = "")
path_data
paste('a','b','c')
symbol_A = 'chr1_libchr1'
symbol_B = 'ref_chr1'
path = "/home/tkastylevsky/results/bedtools_analysis/chr1_libchr1VSref_chr1/"
path_data = paste(path,"data_chr1_libchr1_ref_chr1.csv", sep = "")
path_out_csv = paste(path,'best_hits_',symbol_A,'_on_',symbol_B)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, intersect_A)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, A_intersect)
write.csv(path_out_csv, row.names = FALSE)
write.csv(best_hits_data_A,path_out_csv, row.names = FALSE)
path_out_csv_B = paste(path,'best_hits_',symbol_B,'_on_',symbol_A)
library(csv)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(ggsci)
N=as.string(commandArgs(TRUE)[1])
symbol_A = 'chr1_libchr1'
symbol_B = 'ref_chr1'
as.str()
N=toString(commandArgs(TRUE)[1])
symbol_A = 'chr1_libchr1'
symbol_B = 'ref_chr1'
path = "/home/tkastylevsky/results/bedtools_analysis/chr1_libchr1VSref_chr1/"
path_data = paste(path,"data_chr1_libchr1_ref_chr1.csv", sep = "")
path_out_csv_A = paste(path,'best_hits_',symbol_A,'_on_',symbol_B)
path_out_csv_B = paste(path,'best_hits_',symbol_B,'_on_',symbol_A)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, A_intersect)
write.csv(best_hits_data_A,path_out_csv_A, row.names = FALSE)
best_hits_data_B = rep_intersect %>% group_by(B_ID) %>% top_n(1, B_intersect)
write.csv(best_hits_data_B,path_out_csv_B, row.names = FALSE)
best_hits_data_class = best_hits_data_A %>% group_by(A_repeat_class) %>% count(B_repeat_class)
best_hits_data_class_A_on_B = best_hits_data_A %>% group_by(A_repeat_class) %>% count(B_repeat_class)
View(best_hits_data_class_A_on_B)
library(csv)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(ggsci)
N=toString(commandArgs(TRUE)[1])
symbol_A = 'chr1_libchr1'
symbol_B = 'ref_chr1'
path = "/home/tkastylevsky/results/bedtools_analysis/chr1_libchr1VSref_chr1/"
path_data = paste(path,"data_chr1_libchr1_ref_chr1.csv", sep = "")
path_out_csv_A = paste(path,'best_hits_',symbol_A,'_on_',symbol_B)
path_out_csv_B = paste(path,'best_hits_',symbol_B,'_on_',symbol_A)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('tRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, A_intersect)
write.csv(best_hits_data_A,path_out_csv_A, row.names = FALSE)
best_hits_data_B = rep_intersect %>% group_by(B_ID) %>% top_n(1, B_intersect)
write.csv(best_hits_data_B,path_out_csv_B, row.names = FALSE)
best_hits_data_class_A_on_B = best_hits_data_A %>% group_by(A_repeat_class) %>% count(B_repeat_class)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('[snRNA]|[tRNA]','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
View(rep_intersect)
rep_intersect$B_repeat_class = gsub('(snRNA)|(tRNA)','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('(snRNA)|(tRNA)','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
View(rep_intersect)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, A_intersect)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
View(best_hits_data_class_A_on_B)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA|tRNA','smallRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA|tRNA','smallRNA',rep_intersect$A_repeat_class, fixed = TRUE)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, A_intersect)
best_hits_data_B = rep_intersect %>% group_by(B_ID) %>% top_n(1, B_intersect)
best_hits_data_class_A_on_B = best_hits_data_A %>% group_by(A_repeat_class) %>% count(B_repeat_class)
View(best_hits_data_class_A_on_B)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$A_repeat_class, fixed = TRUE)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, A_intersect)
best_hits_data_B = rep_intersect %>% group_by(B_ID) %>% top_n(1, B_intersect)
best_hits_data_class_A_on_B = best_hits_data_A %>% group_by(A_repeat_class) %>% count(B_repeat_class)
View(best_hits_data_class_A_on_B)
rep_intersect = read.csv(path_data, header=TRUE)
rep_intersect$B_repeat_class = gsub("?",'',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('Unspecified','Unknown',rep_intersect$B_repeat_class, fixed = TRUE)
rep_intersect$B_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$B_repeat_class)
rep_intersect$A_repeat_class = gsub("?",'',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('Unspecified','Unknown',rep_intersect$A_repeat_class, fixed = TRUE)
rep_intersect$A_repeat_class = gsub('snRNA|tRNA','snRNA/tRNA',rep_intersect$A_repeat_class)
best_hits_data_A = rep_intersect %>% group_by(A_ID) %>% top_n(1, A_intersect)
best_hits_data_B = rep_intersect %>% group_by(B_ID) %>% top_n(1, B_intersect)
best_hits_data_class_A_on_B = best_hits_data_A %>% group_by(A_repeat_class) %>% count(B_repeat_class)
path_out_png_A = paste(path,'best_hits_',symbol_A,'_on_',symbol_B)
ans1 = ggplot(best_hits_data_class_A_on_B, aes(fill=B_repeat_class, y=n, x=A_repeat_class)) +
geom_bar(position="stack", stat="identity") +
scale_y_log10()+
scale_fill_brewer(palette="Paired") +
ggsave(paste(path_out_png_A,'.png'), height = 5, width =10)
ans2 = ggplot(best_hits_data_class, aes(fill=B_repeat_class, y=n, x=A_repeat_class)) +
geom_bar(position="fill", stat="identity") +
scale_fill_brewer(palette="Paired") +
ggsave(paste(path_out_png_A,'_perc.png'), height = 5, width =10)
ans2 = ggplot(best_hits_data_class_A_on_B, aes(fill=B_repeat_class, y=n, x=A_repeat_class)) +
geom_bar(position="fill", stat="identity") +
scale_fill_brewer(palette="Paired") +
ggsave(paste(path_out_png_A,'_perc.png'), height = 5, width =10)
best_hits_data_class_B_on_A = best_hits_data_B %>% group_by(B_repeat_class) %>% count(A_repeat_class)
View(best_hits_data_class_B_on_A)
best_hits_data_class_B_on_A = best_hits_data_B %>% group_by(B_repeat_class) %>% count(A_repeat_class)
ans3 = ggplot(best_hits_data_class_B_on_A, aes(fill=A_repeat_class, y=n, x=B_repeat_class)) +
geom_bar(position="stack", stat="identity") +
scale_y_log10()+
scale_fill_brewer(palette="Paired") +
ggsave(paste(path_out_csv_B,'.png'), height = 5, width =10)
ans4 = ggplot(best_hits_data_class_B_on_A, aes(fill=A_repeat_class, y=n, x=B_repeat_class)) +
geom_bar(position="fill", stat="identity") +
scale_fill_brewer(palette="Paired") +
ggsave(paste(path_out_csv_B,'_perc.png'), height = 5, width =10)
